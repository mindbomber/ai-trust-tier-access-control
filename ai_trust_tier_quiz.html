<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Which AI Trust Tier Are You?</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="start-screen">
        <h1>What Level of AI Power Should You Be Trusted With?</h1>
        <h2>Take this short test to find out how much chaos you could unleash.</h2>
        <p>
            Welcome to the only quiz that determines if you‚Äôre a digital saint, a creative tinkerer, or a future headline in the AI Incident Report. <br><br>
            <strong>AI safety</strong> isn‚Äôt just for the robots‚Äîit‚Äôs for the humans who think they can outsmart them. Answer honestly (or don‚Äôt, but the AI will know). <br><br>
            <em>Remember: With great power comes great responsibility... and sometimes, great disaster. Let‚Äôs see if you‚Äôre ready for the keys to the AI kingdom‚Äîor if you should stick to Minesweeper.</em>
        </p>
        <button id="start-btn">Start Quiz</button>
    </div>
    <div id="quiz-container" style="display:none;"></div>

    <div class="results" id="results" style="display:none;" aria-live="polite">
        <h2 id="results-congrats"></h2>
        <button id="reveal-results-btn" title="Reveal your fate! (But remember: with great access comes great responsibility)">üîì Click here to reveal your access level (if you dare...)</button>
        <p id="result-text" style="display:none;"></p>
        <div id="ai-safety-message">
            ü§î <em>Remember: The real question isn‚Äôt just what you‚Äôd do with AI power‚Äîit‚Äôs who else might get the keys. In a world where one clever prompt can change everything, are we ready for the consequences of digital mischief? AI doesn‚Äôt judge, but maybe we should.</em>
        </div>
        <div id="restart-warning" style="display:none; color:#b00; background:#fff3cd; border:1px solid #ffeeba; padding:1em; border-radius:8px; margin-bottom:1em; font-weight:bold; text-align:center;"></div>
        <button id="restart-btn" 
            title="Careful! Every retry brings you one step closer to being flagged for 'excessive optimism.' AI access is a privilege, not a right. üòâ"
            disabled>
            ‚Ü©Ô∏è Try again? (The AI is still judging you)
        </button>
        <p><a href="https://github.com/mindbomber/ai-trust-tier-access-control/blob/main/WHITEPAPER.md" target="_blank">Learn about the real AI Trust Tier Framework (Whitepaper)</a></p>
        <div id="share-cta">
            <strong>Share your AI Trust Tier (and tempt fate):</strong><br>
            <a href="#" id="share-x" title="Share on X (Twitter)">üê¶ X</a>
            <a href="#" id="share-fb" title="Share on Facebook">üìò Facebook</a>
            <a href="#" id="share-li" title="Share on LinkedIn">üíº LinkedIn</a>
            <a href="https://github.com/mindbomber/ai-trust-tier-access-control" target="_blank" title="Contribute on GitHub">üíª Contribute</a>
        </div>
    </div>

    <script src="questions.js"></script>
    <script src="results.js"></script>
    <script>
    (function() {
        let questionsPerQuiz = 5;
        let currentQuestion = 0;
        let totalPoints = 0;
        let randomizedQuestions = [];
        let restartCount = 0;
        let resultsRevealed = false;

        // Use the starter set for the first run, then randomize from the full set on restart
        document.getElementById('start-btn').onclick = function() {
            questionsPerQuiz = 5;
            restartCount = 0;
            currentQuestion = 0;
            totalPoints = 0;
            // Use only the starter set for the first run, but select randomly
            randomizedQuestions = shuffle(window.starterQuestions).slice(0, questionsPerQuiz);
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'block';
            document.getElementById('results').style.display = 'none'; // Hide results if visible
            showQuestion();
        };

        // Helper to shuffle questions array
        function shuffle(array) {
            let arr = array.slice();
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function showQuestion() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';
            if (currentQuestion >= randomizedQuestions.length) {
                showResults();
                return;
            }
            const qObj = randomizedQuestions[currentQuestion];
            // Use <fieldset> and <legend> for accessibility
            const fieldset = document.createElement('fieldset');
            fieldset.classList.add('question-fieldset');
            const legend = document.createElement('legend');
            legend.innerHTML = `Q${currentQuestion + 1}: ${qObj.q}`;
            fieldset.appendChild(legend);

            // Use <ul> and <li> for answer options
            const ul = document.createElement('ul');
            ul.classList.add('answers');
            qObj.options.forEach((opt, idx) => {
                const li = document.createElement('li');
                const btn = document.createElement('button');
                btn.textContent = opt.text;
                btn.onclick = () => {
                    // Disable all buttons after selection to prevent double clicks
                    Array.from(ul.querySelectorAll('button')).forEach(b => b.disabled = true);
                    totalPoints += opt.points;
                    currentQuestion++;
                    // Add a short delay before showing the next question for better UX
                    setTimeout(showQuestion, 200);
                };
                li.appendChild(btn);
                ul.appendChild(li);
            });
            fieldset.appendChild(ul);
            container.appendChild(fieldset);

            // Add horizontal progress bar BELOW the question/answers, with spacing
            const progressBarWrapper = document.createElement('div');
            progressBarWrapper.style.marginTop = '32px'; // Add spacing above the progress bar
            const progressBar = document.createElement('div');
            progressBar.className = 'progress-bar';
            progressBar.style.width = '100%';
            progressBar.style.background = '#eee';
            progressBar.style.borderRadius = '8px';
            progressBar.style.overflow = 'hidden';
            progressBar.style.height = '18px';
            const progressFill = document.createElement('div');
            progressFill.className = 'progress-bar-fill';
            // Use questionsPerQuiz instead of QUESTIONS_PER_QUIZ
            const percent = ((currentQuestion) / questionsPerQuiz) * 100;
            progressFill.style.width = percent + '%';
            progressFill.style.height = '100%';
            progressFill.style.background = 'linear-gradient(90deg, #4f8cff, #00e6e6)';
            progressFill.style.transition = 'width 0.4s';
            progressBar.appendChild(progressFill);
            progressBarWrapper.appendChild(progressBar);
            // Add quirky, dark-humored progress text below the bar
            const progressDiv = document.createElement('div');
            progressDiv.classList.add('progress');
            progressDiv.style.marginBottom = '10px';
            progressDiv.style.fontStyle = 'italic';
            progressDiv.style.color = '#666';
            progressDiv.style.marginTop = '8px';
            const progressQuips = [
                "Advance for a shot at AI clearance... or risk being flagged for digital mischief.",
                "One step closer to the AI mainframe. Or the blacklist.",
                "Keep going. The AI is watching. Always.",
                "Your answers are being logged for future robot overlords.",
                "Almost there! Hope you like digital ankle monitors.",
                "Proceed with caution. AI trust is a fragile thing.",
                "Every click brings you closer to the singularity... or security review.",
                "You‚Äôre either a saint or a supervillain. The quiz will decide.",
                "Remember: AI never forgets. Neither do we.",
                "This is not a test. (Okay, it is. But still.)"
            ];
            const quip = progressQuips[currentQuestion % progressQuips.length];
            progressDiv.innerHTML = `<span style="font-size:1.5em;vertical-align:middle;"></span> <strong>Question ${currentQuestion + 1} of ${questionsPerQuiz}</strong> &mdash; <span>${quip}</span>`;
            progressBarWrapper.appendChild(progressDiv);
            container.appendChild(progressBarWrapper);
        }

        function showResults() {
            document.getElementById('quiz-container').style.display = 'none';
            const resultBox = document.getElementById('results');
            const resText = document.getElementById('result-text');
            const revealBtn = document.getElementById('reveal-results-btn');
            const restartBtn = document.getElementById('restart-btn');
            resultsRevealed = false;
            restartBtn.disabled = true; // Disable restart until results are revealed

            // Random quirky/sarcastic congrats messages
            const congratsMessages = [
                "Congrats, you finished the quiz without being flagged by Interpol ‚Äî progress!",
                "You‚Äôve officially been judged by an algorithm ‚Äî and somehow survived.",
                "Well done, future overlord... or obedient spreadsheet user.",
                "You passed! Depending on how low your standards are.",
                "Congratulations ‚Äî we now know exactly how dangerous you are.",
                "Finished the quiz? Great. AI is printing your trust certificate on invisible paper.",
                "You‚Äôve been categorized, profiled, and possibly reported ‚Äî cheers!",
                "You did it! A questionable achievement, but an achievement nonetheless.",
                "Big claps for completing a test that says you might be a threat to humanity.",
                "That‚Äôs it. No prize. Just self-awareness and mild government scrutiny."
            ];
            document.getElementById('results-congrats').textContent = congratsMessages[Math.floor(Math.random() * congratsMessages.length)];

            // Use percentage-based getTier function
            const maxPoints = questionsPerQuiz * 4;
            const percent = totalPoints / maxPoints;
            const result = window.getTier(percent); // Pass percent instead of totalPoints
            resText.innerHTML = result.text;
            resText.style.display = 'none';
            resultBox.style.display = 'block';

            // Hide results until reveal button is clicked
            revealBtn.style.display = 'inline-block';
            revealBtn.onclick = function() {
                revealBtn.style.display = 'none';
                resText.style.display = 'block';
                resultsRevealed = true;
                restartBtn.disabled = false; // Enable restart now
            };

            // Quirky pop-up messages
            const quirkyPopups = [
                "Patience, human! The AI hasn't finished judging you yet.",
                "You can't escape your fate that easily. Reveal your results first!",
                "Nice try! Even AI needs closure before a restart.",
                "First see your results, then you may try again. The suspense is part of the fun.",
                "Whoa! The AI insists you face your digital destiny before another round.",
                "Results first, existential crisis later.",
                "Reveal your fate before you tempt it again!",
                "The AI is still calculating your trustworthiness. Wait for it...",
                "You must be judged before you can be redeemed. Click 'Reveal Results'!",
                "No speedrunning the quiz! Results come before retries."
            ];

            // Always set restartBtn.enabled and attach the click handler
            const warningDiv = document.getElementById('restart-warning');
            warningDiv.style.display = 'none';
            restartBtn.disabled = false; // Always enabled
            restartBtn.onclick = function(e) {
                if (!resultsRevealed) {
                    const msg = quirkyPopups[Math.floor(Math.random() * quirkyPopups.length)];
                    warningDiv.textContent = msg;
                    warningDiv.style.display = 'block';
                    setTimeout(() => { warningDiv.style.display = 'none'; }, 3500);
                    e.preventDefault();
                    return false;
                }
                warningDiv.style.display = 'none';
                restartQuiz();
            };

            // Social share logic
            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent('I got ' + result.tier + ' on the AI Trust Tier Quiz! Find your tier:');
            document.getElementById('share-x').href = `https://twitter.com/intent/tweet?text=${text}&url=${url}`;
            document.getElementById('share-fb').href = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
            document.getElementById('share-li').href = `https://www.linkedin.com/shareArticle?mini=true&url=${url}&title=AI%20Trust%20Tier%20Quiz&summary=${text}`;
        }

        function showFunnyScreen() {
            const funnyMessages = [
                "<span style='font-size:2em;'>ü§ñüö®</span><br><strong>AI Safety Alert:</strong> You've restarted this quiz more times than an AI ethics committee rewrites its guidelines. Maybe it's time to apply for a security clearance... or a nap!",
                "<span style='font-size:2em;'>üõëüîê</span><br><strong>Access Denied:</strong> Your restart privileges are under review. Please step away from the keyboard and let the AI cool down.",
                "<span style='font-size:2em;'>üëÄü§î</span><br><strong>Suspicious Activity Detected:</strong> Either you're a perfectionist or you're training for the AI Olympics. Either way, the robots are watching.",
                "<span style='font-size:2em;'>üíæü¶æ</span><br><strong>Quiz Overload:</strong> You've triggered the digital equivalent of a fire drill. Please proceed to the nearest exit (or just try Minesweeper).",
                "<span style='font-size:2em;'>üß†üîí</span><br><strong>AI Trust Tier: Infinite Loop</strong><br>Congratulations, you have achieved the rare 'Quiz Addict' status. The AI is now questioning <em>your</em> access privileges!"
            ];
            const msg = funnyMessages[Math.floor(Math.random() * funnyMessages.length)];
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('results').style.display = 'block';
            document.getElementById('results-congrats').innerHTML = '';
            document.getElementById('result-text').innerHTML = `<div style="text-align:center; font-size:1.25em; margin:2.5em auto; max-width:600px;">${msg}<br><br><button onclick='location.reload()' style='margin-top:2em; font-size:1.1em; padding:0.7em 2em; border-radius:8px; background:#4f8cff; color:#fff; border:none; cursor:pointer;'>üîÑ Refresh Reality</button></div>`;
            document.getElementById('result-text').style.display = 'block';
            document.getElementById('reveal-results-btn').style.display = 'none';
            document.getElementById('ai-safety-message').style.display = 'none';
            document.getElementById('restart-btn').style.display = 'none';
            document.getElementById('share-cta').style.display = 'none';
        }

        function restartQuiz() {
            restartCount++;
            if (restartCount > 5) {
                showFunnyScreen();
                return;
            }
            questionsPerQuiz += 3;
            currentQuestion = 0;
            totalPoints = 0;
            // After first run, randomize from the full set
            randomizedQuestions = shuffle(window.questions).slice(0, questionsPerQuiz);
            document.getElementById('results').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'block';
            showQuestion();
        }
    })();
    </script>
</body>
</html>
